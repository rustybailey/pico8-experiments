pico-8 cartridge // http://www.pico-8.com
version 16
__lua__

world = {
	max_x = 127,
	max_y = 127,
	counter = 1
}

buggy={
	x=20,
	y=64,
	w=16,
	h=16,
	dx=0,
	dy=0,
	ddx=0,
	ddy=0,
	acceleration = .25,
	friction = 0.8,
	max_speed = 3,
	sprite = 1,
	sprites = {1,3,5},
	idle = true,
	flipspr = false,
	bounce = 3,
	update=function(self)
		self.ddx = 0
		if(btn(0)) then
			self.ddx=-self.acceleration
			self.flipspr = true
			self.idle = false
		elseif(btn(1)) then
			self.ddx=self.acceleration
			self.flipspr = false
			self.idle = false
		else
			self.idle=true
		end

		-- todo: jumping

		if self.ddx == 0 then
			self.dx *= self.friction
		end

		self.dx+=self.ddx


		if self.dx > self.max_speed then
	    self.dx = self.max_speed
		elseif self.dx < -self.max_speed then
	    self.dx = -self.max_speed
		end

		self.x+=self.dx

		if (self.x < 0) then
			self.x = 0
		end

		if (self.x + self.w > world.max_x) then
			self.x = world.max_x - self.w
		end

		-- todo: don't overflow
	  world.counter += 1

	  if self.idle then
	  	self.bounce = 3
	  else
	  	self.bounce = 2
	  end
	  if world.counter % self.bounce == 0 then
	  	self.sprite += 1
	  end
	  if self.sprite > #self.sprites then
	  	self.sprite = 1
	  end

	  -- todo: get puffs of smoke coming out of the tailpipe
	end,
	draw=function(self)
		spr(self.sprites[self.sprite],self.x,self.y,2,2,self.flipspr)
	end
}
function _update()
	buggy:update()
end

function _draw()
	cls()
	buggy:draw()
	line(0,80,128,80)
	print(world.counter, 6, 6)
	print(buggy.dx, 6, 12)
end
__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000444400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000004444000000000004444470000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000044444700000000044444477000000000044440000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000444444770000000044444477000000000444447000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000444444770000000444444477000000004444447700000000000000000000000000000000000000000000000000000000000000000000000000000
00000000004444444770000000499444444440000004444447700000000000000000000000000000000000000000000000000000000000000000000000000000
00000000004994444444400000499444444444400044444447700000000000000000000000000000000000000000000000000000000000000000000000000000
00000000004994444444444033444444444444400049944444444000000000000000000000000000000000000000000000000000000000000000000000000000
00000000334444444444444000222200002222000049944444444440000000000000000000000000000000000000000000000000000000000000000000000000
00000000002222000022220000222200002222003344444444444440000000000000000000000000000000000000000000000000000000000000000000000000
00000000000220000002200000022000000220000002200000022000000000000000000000000000000000000000000000000000000000000000000000000000
